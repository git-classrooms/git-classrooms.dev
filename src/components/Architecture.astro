---
import type { Locale } from "../i18n";
import { useTranslations } from "../i18n";

interface Props {
  locale: Locale;
}

const { locale } = Astro.props;
const t = useTranslations(locale).architecture;
---

<section id="architecture" class="relative z-10 py-24 md:py-32">
  <div class="mx-auto max-w-6xl px-6">
    <div class="text-center mb-16">
      <h2
        class="font-mono font-bold text-3xl md:text-4xl tracking-tight animate-fade-in-up"
      >
        {t.heading}{" "}
        <span class="gradient-text">{t.headingHighlight}</span>
      </h2>
      <p
        class="mt-4 text-muted text-lg max-w-2xl mx-auto animate-fade-in-up"
        style="animation-delay: 0.1s"
      >
        {t.subline}
      </p>
    </div>

    <div
      class="flex flex-col lg:flex-row items-center justify-center gap-4 lg:gap-0 max-w-4xl mx-auto animate-fade-in-up"
      style="animation-delay: 0.2s"
    >
      <!-- GitLab Instance -->
      <div
        class="w-full max-w-[260px] glass rounded-xl p-5 text-center hover:border-primary/30 transition-all duration-300"
      >
        <div
          class="w-10 h-10 rounded-lg bg-primary/10 border border-primary/20 flex items-center justify-center mx-auto mb-3"
        >
          <svg
            class="w-5 h-5 text-primary"
            viewBox="0 0 16 16"
            fill="currentColor"
          >
            <path
              d="M11.75 2.5a.75.75 0 1 0 0 1.5.75.75 0 0 0 0-1.5zm-2.25.75a2.25 2.25 0 1 1 3 2.122V6A2.5 2.5 0 0 1 10 8.5H6a1 1 0 0 0-1 1v1.128a2.251 2.251 0 1 1-1.5 0V5.372a2.25 2.25 0 1 1 1.5 0v1.836A2.493 2.493 0 0 1 6 7h4a1 1 0 0 0 1-1v-.628A2.25 2.25 0 0 1 9.5 3.25zM4.25 12a.75.75 0 1 0 0 1.5.75.75 0 0 0 0-1.5zM3.5 3.25a.75.75 0 1 0 1.5 0 .75.75 0 0 0-1.5 0z"
            ></path>
          </svg>
        </div>
        <h3 class="font-mono font-semibold text-sm">{t.components.gitlab}</h3>
        <p class="text-[11px] text-muted mt-1.5 leading-relaxed">
          {t.components.gitlabDesc}
        </p>
      </div>

      <!-- Connection 1: GitLab ↔ API -->
      <div class="hidden lg:flex items-center shrink-0 px-1">
        <svg
          width="80"
          height="24"
          viewBox="0 0 80 24"
          class="overflow-visible"
        >
          <line
            x1="0"
            y1="12"
            x2="80"
            y2="12"
            stroke="hsl(185 100% 50%)"
            stroke-width="1"
            opacity="0.15"></line>
          <circle r="2.5" fill="hsl(185 100% 50%)">
            <animateMotion
              dur="2.5s"
              repeatCount="indefinite"
              path="M0,12 L80,12"></animateMotion>
            <animate
              attributeName="opacity"
              values="0;0.7;0.7;0"
              dur="2.5s"
              repeatCount="indefinite"></animate>
          </circle>
          <circle r="2" fill="hsl(280 100% 60%)">
            <animateMotion
              dur="3s"
              repeatCount="indefinite"
              begin="1.2s"
              path="M80,12 L0,12"></animateMotion>
            <animate
              attributeName="opacity"
              values="0;0.5;0.5;0"
              dur="3s"
              repeatCount="indefinite"
              begin="1.2s"></animate>
          </circle>
        </svg>
      </div>
      <div class="lg:hidden shrink-0">
        <svg width="24" height="36" viewBox="0 0 24 36" class="overflow-visible">
          <line
            x1="12"
            y1="0"
            x2="12"
            y2="36"
            stroke="hsl(185 100% 50%)"
            stroke-width="1"
            opacity="0.15"></line>
          <circle r="2.5" fill="hsl(185 100% 50%)">
            <animateMotion
              dur="2s"
              repeatCount="indefinite"
              path="M12,0 L12,36"></animateMotion>
            <animate
              attributeName="opacity"
              values="0;0.7;0.7;0"
              dur="2s"
              repeatCount="indefinite"></animate>
          </circle>
          <circle r="2" fill="hsl(280 100% 60%)">
            <animateMotion
              dur="2.5s"
              repeatCount="indefinite"
              begin="0.8s"
              path="M12,36 L12,0"></animateMotion>
            <animate
              attributeName="opacity"
              values="0;0.5;0.5;0"
              dur="2.5s"
              repeatCount="indefinite"
              begin="0.8s"></animate>
          </circle>
        </svg>
      </div>

      <!-- git-classrooms API (center) -->
      <div
        class="w-full max-w-[280px] glass rounded-xl p-5 text-center border-primary/10 hover:border-primary/30 transition-all duration-300"
      >
        <div
          class="w-10 h-10 rounded-lg bg-gradient-to-br from-primary/15 to-[hsl(280,100%,60%)]/15 border border-primary/20 flex items-center justify-center mx-auto mb-3"
        >
          <svg
            viewBox="0 0 24 24"
            fill="none"
            class="w-5 h-5"
            stroke-width="1.8"
            stroke-linecap="round"
          >
            <path d="M12 2 L12 6" class="stroke-primary"></path>
            <path d="M12 6 L6 12" class="stroke-primary"></path>
            <path d="M12 6 L18 12" class="stroke-primary"></path>
            <path d="M6 12 L12 18" class="stroke-[hsl(280,100%,60%)]"></path>
            <path d="M18 12 L12 18" class="stroke-[hsl(280,100%,60%)]"></path>
            <path d="M12 18 L12 22" class="stroke-[hsl(280,100%,60%)]"></path>
            <circle cx="12" cy="6" r="1.8" class="fill-primary"></circle>
            <circle cx="6" cy="12" r="1.8" class="fill-primary" opacity="0.8"
            ></circle>
            <circle
              cx="18"
              cy="12"
              r="1.8"
              class="fill-[hsl(280,100%,60%)]"
              opacity="0.8"></circle>
            <circle cx="12" cy="18" r="1.8" class="fill-[hsl(280,100%,60%)]"
            ></circle>
          </svg>
        </div>
        <h3 class="font-mono font-semibold text-sm">{t.components.api}</h3>
        <p class="text-[11px] text-muted mt-1.5 leading-relaxed">
          {t.components.apiDesc}
        </p>
        <div
          class="mt-3 inline-flex items-center gap-1.5 px-2.5 py-1 rounded-md bg-background/60 border border-border/50"
        >
          <svg
            class="w-3 h-3 text-primary/60"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
          >
            <ellipse cx="12" cy="5" rx="9" ry="3"></ellipse>
            <path d="M21 12c0 1.66-4.03 3-9 3s-9-1.34-9-3"></path>
            <path d="M3 5v14c0 1.66 4.03 3 9 3s9-1.34 9-3V5"></path>
          </svg>
          <span class="text-[10px] font-mono text-muted"
            >{t.components.db}</span
          >
        </div>
      </div>

      <!-- Connection 2: API ↔ Dashboard -->
      <div class="hidden lg:flex items-center shrink-0 px-1">
        <svg
          width="80"
          height="24"
          viewBox="0 0 80 24"
          class="overflow-visible"
        >
          <line
            x1="0"
            y1="12"
            x2="80"
            y2="12"
            stroke="hsl(280 100% 60%)"
            stroke-width="1"
            opacity="0.15"></line>
          <circle r="2.5" fill="hsl(280 100% 60%)">
            <animateMotion
              dur="2.8s"
              repeatCount="indefinite"
              begin="0.5s"
              path="M0,12 L80,12"></animateMotion>
            <animate
              attributeName="opacity"
              values="0;0.6;0.6;0"
              dur="2.8s"
              repeatCount="indefinite"
              begin="0.5s"></animate>
          </circle>
          <circle r="2" fill="hsl(185 100% 50%)">
            <animateMotion
              dur="3.2s"
              repeatCount="indefinite"
              begin="2s"
              path="M80,12 L0,12"></animateMotion>
            <animate
              attributeName="opacity"
              values="0;0.5;0.5;0"
              dur="3.2s"
              repeatCount="indefinite"
              begin="2s"></animate>
          </circle>
        </svg>
      </div>
      <div class="lg:hidden shrink-0">
        <svg width="24" height="36" viewBox="0 0 24 36" class="overflow-visible">
          <line
            x1="12"
            y1="0"
            x2="12"
            y2="36"
            stroke="hsl(280 100% 60%)"
            stroke-width="1"
            opacity="0.15"></line>
          <circle r="2.5" fill="hsl(280 100% 60%)">
            <animateMotion
              dur="2s"
              repeatCount="indefinite"
              begin="0.3s"
              path="M12,0 L12,36"></animateMotion>
            <animate
              attributeName="opacity"
              values="0;0.6;0.6;0"
              dur="2s"
              repeatCount="indefinite"
              begin="0.3s"></animate>
          </circle>
          <circle r="2" fill="hsl(185 100% 50%)">
            <animateMotion
              dur="2.5s"
              repeatCount="indefinite"
              begin="1.5s"
              path="M12,36 L12,0"></animateMotion>
            <animate
              attributeName="opacity"
              values="0;0.5;0.5;0"
              dur="2.5s"
              repeatCount="indefinite"
              begin="1.5s"></animate>
          </circle>
        </svg>
      </div>

      <!-- Dashboard -->
      <div
        class="w-full max-w-[260px] glass rounded-xl p-5 text-center hover:border-[hsl(280,100%,60%)]/30 transition-all duration-300"
      >
        <div
          class="w-10 h-10 rounded-lg bg-[hsl(280,100%,60%)]/10 border border-[hsl(280,100%,60%)]/20 flex items-center justify-center mx-auto mb-3"
        >
          <svg
            class="w-5 h-5 text-[hsl(280,100%,70%)]"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
          >
            <rect x="2" y="3" width="20" height="14" rx="2" ry="2"></rect>
            <line x1="8" y1="21" x2="16" y2="21"></line>
            <line x1="12" y1="17" x2="12" y2="21"></line>
          </svg>
        </div>
        <h3 class="font-mono font-semibold text-sm">
          {t.components.dashboard}
        </h3>
        <p class="text-[11px] text-muted mt-1.5 leading-relaxed">
          {t.components.dashboardDesc}
        </p>
      </div>
    </div>
  </div>
</section>
